import{_ as p,b as h,o as _,c,a as e,t as r,n as l,w as u,d as m,v as d}from"./index-193cd5e6.js";const f={data(){return{emptyInput:!1,showHamster:!1,userData:{userId:"",lastName:"",phoneNumber:"",email:"",firstName:"",dateOfBirth:"",role:""},editsButtons:{dateOfBirth:!1,phoneNumberEdit:!1,emailEdit:!1,firstNameEdit:!1,lastNameEdit:!1}}},mounted(){this.setNewToken(),this.displayUserData()},methods:{displayUserData(){const n=localStorage.getItem("jwtToken"),t=JSON.parse(atob(n.split(".")[1]));this.userData.dateOfBirth=t.DateOfBirth,this.userData.phoneNumber=t.PhoneNumber,this.userData.email=t.Email,this.userData.role=t["http://schemas.microsoft.com/ws/2008/06/identity/claims/role"],this.userData.firstName=t.FirstName,this.userData.lastName=t.SecondName},async dataChange(){const n=localStorage.getItem("jwtToken");if(!n)return;const t=JSON.parse(atob(n.split(".")[1]));if(this.userData.userId=t["http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier"],(Object.entries(this.userData)[1][1].length<=0||Object.entries(this.userData)[2][1].length<=0||Object.entries(this.userData)[3][1].length<=0||Object.entries(this.userData)[4][1].length<=0||Object.entries(this.userData)[5][1].length<=0)&&(this.emptyInput=!0),this.emptyInput)console.log("Uzupełnij wszystkie pola.");else try{const o=await h.put("https://servicedeskinz2023.azurewebsites.net/api/accountManagement/updateUser",{id:this.userData.userId,firstName:this.userData.firstName,secondName:this.userData.lastName,phoneNumber:this.userData.phoneNumber.toString(),email:this.userData.email,dateOfBirth:this.userData.dateOfBirth},{headers:{Authorization:"Bearer "+n}}).then(this.showHamster=!0,setTimeout(()=>{this.showHamster=!1,window.location.href="/user-menu"},2e3))}catch(o){console.error(o)}},async setNewToken(){const n=localStorage.getItem("jwtToken");if(n)try{const t=await h.get("https://servicedeskinz2023.azurewebsites.net/api/account/extendtoken",{headers:{Authorization:"Bearer "+n}}).then(o=>{localStorage.setItem("jwtToken",o.data)})}catch(t){console.log(t)}}}},b={class:"current-user-page"},g=e("h1",{class:"current-user-page__title"},"Twoje dane",-1),N=e("p",{class:"current-user-page__info"},"Jeśli Twoje dane nie zostały zaktualizowane, odświez stronę.",-1),D={class:"current-user-page__data"},w=e("strong",null,"Imię: ",-1),v=e("button",null,"Zapisz",-1),B=e("strong",null,"Nazwisko: ",-1),y=e("button",null,"Zapisz",-1),k=e("strong",null,"Email: ",-1),z=e("button",null,"Zapisz",-1),O=e("strong",null,"Data urodzin: ",-1),C=e("button",null,"Zapisz",-1),E=e("strong",null,"Telefon: ",-1),I=e("button",null,"Zapisz",-1),j=e("strong",null,"Rola: ",-1),S=e("div",{class:"current-user-page__hamster-bgc"},null,-1),T=e("div",{class:"current-user-page__hamster-wrapper"},[e("div",{class:"current-user-page__hamster-content"},[e("div",{"aria-label":"Orange and tan hamster running in a metal wheel",role:"img",class:"wheel-and-hamster"},[e("div",{class:"wheel"}),e("div",{class:"hamster"},[e("div",{class:"hamster__body"},[e("div",{class:"hamster__head"},[e("div",{class:"hamster__ear"}),e("div",{class:"hamster__eye"}),e("div",{class:"hamster__nose"})]),e("div",{class:"hamster__limb hamster__limb--fr"}),e("div",{class:"hamster__limb hamster__limb--fl"}),e("div",{class:"hamster__limb hamster__limb--br"}),e("div",{class:"hamster__limb hamster__limb--bl"}),e("div",{class:"hamster__tail"})])]),e("div",{class:"spoke"})])])],-1),x=[S,T];function U(n,t,o,V,s,i){return _(),c("div",b,[g,N,e("div",D,[e("ul",null,[e("li",null,[w,e("p",null,r(s.userData.firstName),1),e("span",{onClick:t[0]||(t[0]=a=>s.editsButtons.firstNameEdit=!s.editsButtons.firstNameEdit),class:"material-symbols-outlined edit"},"edit"),e("form",{class:l({showInput:s.editsButtons.firstNameEdit}),onSubmit:t[2]||(t[2]=u((...a)=>i.dataChange&&i.dataChange(...a),["prevent"]))},[m(e("input",{"onUpdate:modelValue":t[1]||(t[1]=a=>s.userData.firstName=a),type:"text"},null,512),[[d,s.userData.firstName]]),v],34)]),e("li",null,[B,e("p",null,r(s.userData.lastName),1),e("span",{onClick:t[3]||(t[3]=a=>s.editsButtons.lastNameEdit=!s.editsButtons.lastNameEdit),class:"material-symbols-outlined edit"},"edit"),e("form",{class:l({showInput:s.editsButtons.lastNameEdit}),onSubmit:t[5]||(t[5]=u((...a)=>i.dataChange&&i.dataChange(...a),["prevent"]))},[m(e("input",{"onUpdate:modelValue":t[4]||(t[4]=a=>s.userData.lastName=a),type:"text"},null,512),[[d,s.userData.lastName]]),y],34)]),e("li",null,[k,e("p",null,r(s.userData.email),1),e("span",{onClick:t[6]||(t[6]=a=>s.editsButtons.emailEdit=!s.editsButtons.emailEdit),class:"material-symbols-outlined edit"},"edit"),e("form",{class:l({showInput:s.editsButtons.emailEdit}),onSubmit:t[8]||(t[8]=u((...a)=>i.dataChange&&i.dataChange(...a),["prevent"]))},[m(e("input",{"onUpdate:modelValue":t[7]||(t[7]=a=>s.userData.email=a),type:"text"},null,512),[[d,s.userData.email]]),z],34)]),e("li",null,[O,e("p",null,r(s.userData.dateOfBirth),1),e("span",{onClick:t[9]||(t[9]=a=>s.editsButtons.dateOfBirth=!s.editsButtons.dateOfBirth),class:"material-symbols-outlined edit"},"edit"),e("form",{class:l({showInput:s.editsButtons.dateOfBirth}),onSubmit:t[11]||(t[11]=u((...a)=>i.dataChange&&i.dataChange(...a),["prevent"]))},[m(e("input",{"onUpdate:modelValue":t[10]||(t[10]=a=>s.userData.dateOfBirth=a),type:"text"},null,512),[[d,s.userData.dateOfBirth]]),C],34)]),e("li",null,[E,e("p",null,r(s.userData.phoneNumber),1),e("span",{onClick:t[12]||(t[12]=a=>s.editsButtons.phoneNumberEdit=!s.editsButtons.phoneNumberEdit),class:"material-symbols-outlined edit"},"edit"),e("form",{class:l({showInput:s.editsButtons.phoneNumberEdit}),onSubmit:t[14]||(t[14]=u((...a)=>i.dataChange&&i.dataChange(...a),["prevent"]))},[m(e("input",{"onUpdate:modelValue":t[13]||(t[13]=a=>s.userData.phoneNumber=a),type:"number"},null,512),[[d,s.userData.phoneNumber]]),I],34)]),e("li",null,[j,e("p",null,r(s.userData.role),1)])])]),e("div",{class:l(["current-user-page__hamster",{showHamster:s.showHamster}])},x,2)])}const P=p(f,[["render",U]]);export{P as default};
